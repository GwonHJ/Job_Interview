

# 1. OSI 7 Layer(7계층)

: 네트워크 통신 시 송신자와 수신자가 지켜야할 각 단계의 규칙!!


    Application Layer   (7 Layer) : 응용 계층
    Presentation Layer  (6 Layer) : 표현 계층
    Session Layer       (5 Layer) : 세션 계층
    Transport Layer     (4 Layer) : 전송 계층
    Network Layer       (3 Layer) : 네트워크 계층
    DataLink Layer      (2 Layer) : 데이터 링크 계층
    Physical Layer      (1 Layer) : 물리 계층

-> 아파서 티내다 피나다로 외우면 면접에서 대답 못함!!! 

-> 3,4 Layer는 필수적으로 알고 갈것!!

Application(7Layer)에 가까워질 수록 실제 프로그램에 가까워지고 아래로 내려갈수록 물리적 연결 구간에 가까워 집니다.

아래로 내려갈 수록 Protocol Header가 추가되어 계층 정보를 덧붙인다.


### 계층별 간단 요약
- Application Layer (7 Layer, 응용계층) : 사용자가 UI로 접하는 응용 프로그램과 관련된 계층. 여기에 속한 프로토콜들은 어떠한 방봅으로든 사용자와 직접 접하게 됨. (ex : HTTP, SMTP, DNS 등)
- Transport Layer (4 Layer, 전송계층) : 송신자와 수신자의 논리적 연결(Connection)을 담당하는 부분. 신뢰성 있는 연결을 유지하기 위해서 도와줌. 사용자(Endpoint)간의 연결을 생성하고 데이터를 얼마나 보냈는지, 얼마나 받았는지, 제대로 받았는지 등을 확인. (ex : TCP, UDP 등)
- Network Layer (3 Layer, 네트워크 계층) : IP(Internet Protocol)이 활용되는 부분. Endpoint에서 다른 Endpoint로 갈때, 경로와 목적지를 찾아줌. 이를 Routing으로 부름 (ex : 라우터 등)
- DataLink Layer (2 Layer, 데이터링크 계층) : 같은 네트워크 대역을 사용하는 단말들에 대해 신뢰성 있는 전송을 보장. "MAC address"를 활용하여 같은 구간 내의 Endpoint 혹은 Switching 장비에 전달하며,  1 Layer에 해당하는 물리 계층에 생길 수 있는 오류를 찾아냄.
- Physical Layer (1 Layer, 물리 계층) : 물리적인 계층으로 전기적 신호가 전송되는 구간.


### 계층을 나눈 이유?
-> 장애 발생시 어느 구간이 문제가 생겼는지 명확하게 알기 위함.





# 2. TCP/IP란?
현재 인터넷에서 컴퓨터들이 서로 정보를 주고 받는데 쓰이는 통신하는데 가장 기반이 되는 프로토콜.
인터넷 프로토콜 중 TCP와 IP를 가장 많이 쓰기 때문에 TCP/IT Protocol 로 불림.

       Application Layer        (4 Layer) : 응용 계층
       Transport Layer          (3 Layer) : 전송 계층
       Internet Layer           (2 Layer) : 인터넷 계층
       Network Access Layer     (1 Layer) : 네트워크 엑세스 계층

- IP : 인터넷 프로토콜

- TCP : 전송 조절 프로토콜

IP는 패킷 전달 여부를 보증하지 않고, 패킷을 보낸 순서와 받는 순서가 다를 수 있다.

TCP IP위에서 동작하는 프로토콜로, 데이터 전달을 보증하고 보낸 순서대로 받게 해준다.

=> IP주소 체계를 따르고 IP Routing을 이용해 목적지에 도달. TCP의 특성을 활용해 송신자와 수신자의 논리적 연결을 생성하고 신뢰성을 유지하도록 한다.


### 계층별 간단 요약

- Application Layer(4 Layer, 응용계층) : TCP/UDP 기반의 응용 프로그램을 구현할 때 사용됩니다. (ex : HTTP, SSH 등)
- Transport Layer(3 Layer, 전송계층) : 통신 노드 간의 연결을 제어하고, 신뢰성 있는 데이터 전송을 담당합니다. (TCP, UDP)
- Internet Layer (2 Layer, 인터넷계층) : 통신 노드 간의 IP패킷을 전송하는 기능과 라우팅 기능을 담당
- Network Access Layer (1 Layer, 네트워크 엑세스 계층) : 물리적인 주소로 MAC를 사용. (ex : LAN, 패킷망)



# 3. TCP VS UDP


### TCP(Transmission Control Protocol)

연결형 서비스를 지원하는 전송 계층 프로토콜.
호스트간의 신뢰성 있는 데이터 전달과 흐름제어 및 혼잡제어 등을 제공하는 전송계층.


#### 특징

- 가상 회선 연결방식을 사용하여 연결형 서비스를 제공
- 높은 신뢰성을 보장
- 흐름 제어 : 송신자는 자신이 한 번에 얼마나 보낼 수 있는지, 수신자는 자신이 데이터를 어디까지 받았는지 끊임없이 확인하고 TCP Header내의 'Window size'를 사용해 한번에 받고, 보낼 수 있는 데이터의 양을 정합니다.
- 혼잡 제어 : 데이터를 주고받는 양 단말(Endpoint)도 중요하지만, 데이터가 지나가는 네트워크 망의 혼잡 또한 중요합니다. 송신자는 연결 초기에 데이터 송출량을 낮게 잡고 보내면서, 수신자의 수신을 확인하면서 송출량을 늘립니다. 이렇게해서 네트워크에서 가장 적합한 송츌량을 확인 할 수 있습니다.

##### 소켓 통신 과정
- 서버 : 소켓 생성, 주소 할당, 연결 요청 기다림, 요청에 대한 응답
- 클라이언트 : 소켓을 생성, 주소 할당, 연결 요청



### UDP(User Datagram Protocol)

비연결형 서비스를 지원하는 전송계층 프로토콜.
사용자 데이터그램형 프로토콜.
보내는 쪽에서 일방적으로 데이터를 전달하는 통신 프로토콜.


#### 특징
- 데이터 그램형 방식을 사용하여 비연결 서비스를 제공(Port만 확인하여 소켓을 식별하고 송수신)
- 비 신뢰성
- 패킷 오버헤드가 적어 네트워크 부하 감소
- handshaking같은 연결 설정이 없어서 속도가 빠름


#### 소켓 통신 과정
- 서버 : 소켓을 생성 , 주소 할당, 데이터를 송수신
- 클라이언트 : 소켓 생성 후 데이터 


----------------------------------------------------------------------------------------------------------------------





Q. TCP/IP가 무엇인가요??

A. 인터넷에서 컴퓨터들이 서로 정보를 주고 받는데 쓰이는 통신 규약의 모임입니다. Application, Transport, Internet, Network Access 4개의 계층이 있습니다.





Q. OSI 7계층에 대해서 설명해주세요.

A. OSI 7계층은 네트워크 통신 시 송신자와 수신자가 지켜야할 규칙을 단계별로 나눈 것입니다. 
장애가 발생했을때 어느 구간에서 문제가 생긴것을 명확하게 알게 하기 위해서 사용됩니다. 
7계층은 위에서부터 Application계층, Presentation 계층, Session 계층, Transport 계층, Network계층, DataLink 계층, Physical 계층이 있습니다. 
상단에 있을 수록 사용자들이 사용하는 응용프로그램에 가까워지고, 아래로 내려갈 수록 물리적인 연결 구간에 가까워 집니다.






Q. OSI 7계층에서 네트워크 계층(3 Layer)에 대해서 설명해주세요.

A. IP가 활용되는 부분으로, 한 Endpoint가 다른 Endpoint로 가고자 할 경우, 경로와 목적지를 찾아주는 역할을 합니다.
앞에서 말한 과정을 라우팅이라고 하며, 대역이 다른 IP들이 목적지를 향해서 제대로 찾아갈 수 있도록 돕는 역할을 합니다.



Q. OSI 7계층에서 전송 계층(4 Layer)에 대해서 설명해주세요.

A. 송신자와 수신자의 논리적 연결을 담당하는 부분입니다. 신뢰성 있는 연결을 유지할 수 있도록 도와줍니다. Endpoint간의 연결을 생성하고 데이터를 얼마나 보냈는지, 얼마나 받았는지, 제대로 받았는지 등을 확인 합니다. 대표적인 예로는 TCP와 UDP가 있습니다.






Q. TCP와 UDP에 대해서 설명해주세요.

A. TCP는 연결형 서비스로 가상 회선 방식을 제공합니다. 3-way handshaking과정을 통해서 연결을 설정하고 4-way handshaking를 통해서 연결을 해제합니다. 이 덕분에 전송 순서와 높은 신뢰성을 보장합니다. 하지만 udp에 비해서 속도가 느립니다. 그렇기 때문에 속도보다 신뢰성이 중요한 파일 전송과 같은 경우에 사용됩니다.
UDP는 비연결형 서비스로 데이터그램 방식을 제공합니다. TCP와 달리 정보를 주고 받을 때, 정보를 보낸다, 받는다의 신호 절차를 거치지 않습니다. UDP헤더의 CheckSum필드를 통해서 최소한의 오류만을 검출합니다. 그렇기 때문에 속도가 빠르다는 장점이 있습니다. 하지만 TCP에 비해 신뢰성이 낮습니다. 그렇기 때문에 신뢰성보다는 연속성이 중요한 스트리밍 서비스에 주로 사용됩니다. 





Q. 3-way handshaking이 무엇인가요??

A. TCP는 신뢰성 있는 통신을 하기 위해서 송신자와 수신자가 데이터를 전송하기 전에 서로 통신이 가능한지, 얼마나 받을 수 있는 등의 정보를 확인합니다. 
그렇기 때문에 송신자가 수신자에게 SYN을 날려서 통신이 가능한 상태인지 확인합니다. 이때 통신이 가능하기 위해서는 Port가 열려 있어야합니다.
수신자가 송신자로부터 SYN을 받았을때, SYN/ACK를 송신자에게 날려서 통신 준비가 되어있음을 알립니다.
송신자가 SYN/ACK를 받았을때, ACK를 날려서 전송을 시작합니다.
이와 같은 과정을 3-way handshaking이라고 합니다.






Q. 4-way handshaking이 무엇인가요?

A. TCP에서 서버와 클라이언트간의 통신을 끊기 위해서 사용되는 방식입니다. 
1. 클라이언트가 연결을 종료하겠다는 FIN플래그를 전송합니다. 이때 클라이언트는 FIN_WAIT의 상태가 됩니다. 
2. 서버는 FIN플래그를 받고, 클라이언트에 ACK를 보내고 자신의 통신이 끝날때까지 기다립니다. 이때 서버는 CLOSE_WAIT상태가 됩니다. 
3. 서버에서 연결을 종료할 준비가 되면 연결해지를 위한 준비가 되었음을 알리기 위해서 클라이언트에게 FIN플래그를 전송합니다. 이때 서버의 상태는 LAST_ACK가 됩니다. 
4. 클라이언트는 ACK메세지를 확인했다는 메세지를 보냅니다. 그 후 Routing지연이나 패킷의 유실로 재전송이 있을 수 있기 때문에 상태를 TIME_WAIT으로 변경합니다. 
일정 시간이 지나면 세션을 만료하고 연결을 종료시키며 CLOSE상태로 변화시킵니다.
이와 같은 과정을 4-way handshaking입니다.





----------------------------------------------------------------------------------------------
[참고]
https://aws-hyoh.tistory.com/entry/TCPIP-%EC%89%BD%EA%B2%8C-%EC%9D%B4%ED%95%B4%ED%95%98%EA%B8%B0
